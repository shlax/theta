Mini prolog like implementation in scala